<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<title>BAPS Ravi Sabha Arusha</title>

<link rel="stylesheet" href="style.css">
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
  <div class="home-area" onclick="showHome()">
    <img src="https://upload.wikimedia.org/wikipedia/en/4/4a/Baps_logo.svg">
    <h1>BAPS RAVI SABHA ARUSHA</h1>
  </div>
  <div id="menu"></div>
</div>

<!-- HOME -->
<div id="homeSection">

  <img class="banner"
  src="https://yt3.googleusercontent.com/K0FpCc1rgoypETYXlc1fZu5Npp602ZFqfnLSU9ppXGa8QugeatUcCWCWs5jf3Fyyg7MRl8H2=w1707-fcrop64=1,00005a57ffffa5a8-k-c0xffffffff-no-nd-rj">

  <!-- SUMMARY -->
  <div class="summary-section">
    <div class="summary-title">Ravi Sabha Summary</div>
    <div class="summary-wrapper" id="summaryWrapper"></div>
  </div>

  <div class="section">
    <div class="cards">
      <div class="info-card">
        <img src="https://www.baps.org/Data/Sites/1/Media/GalleryImages/25999/WebImages/BAPS_Diwali_Annakut_Celebration_Arusha_01.jpg">
        <p>
          BAPS Shri Swaminarayan Mandir in Arusha, Tanzania is a stunning Hindu temple.
        </p>
      </div>

      <div class="info-card">
        <img src="https://drive.google.com/thumbnail?id=1vrUvmlSM098Ns86fLhENSnU6TXZAaVHl">
        <p>
          Nilkanth Varni inspired us to live a life of devotion, service, and self-improvement.
        </p>
      </div>

      <div class="info-card">
        <img src="https://www.baps.org/Data/Sites/1/Media/GalleryImages/25999/WebImages/BAPS_Diwali_Annakut_Celebration_Arusha_09.jpg">
        <p>
          Akshar Purushottam Darshan is a Hindu philosophy that emphasizes devotion to God.
        </p>
      </div>
    </div>
  </div>
</div>

<!-- PDF HEADER -->
<div id="printHeader">
  <img src="https://upload.wikimedia.org/wikipedia/en/4/4a/Baps_logo.svg">
  <div class="print-title">
    <h2>BAPS Ravi Sabha Programüìú Arusha</h2>
    <div id="printDate"></div>
  </div>
</div>

<div id="pdfBar" style="max-width:720px;margin:10px auto;text-align:right;display:none;">
  <button onclick="window.print()">üìÑ Save Program as PDF</button>
</div>

<div id="scheduleSection"></div>

<table id="pdfTable" style="display:none;">
  <thead>
    <tr>
      <th>Time</th>
      <th>Duty</th>
      <th>Assigned To</th>
      <th>Details</th>
    </tr>
  </thead>
  <tbody id="pdfTableBody"></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzE3OI3YhAArf_dqauP33K_hTN6GFK_tTuAG-Rr3vCLhvvWOKJtinavDcfZ_Dn7CpLA/exec";

let dates = [];
let rows = [];
let summaries = [];

fetch(API_URL)
  .then(res => res.json())
  .then(data => {
    dates = data.dates || [];
    rows = data.rows || [];
    summaries = data.summaries || [];
    renderMenu();
    renderSummary();
  })
  .catch(err => console.error(err));

const menu = document.getElementById("menu");
const homeSection = document.getElementById("homeSection");
const scheduleSection = document.getElementById("scheduleSection");

function renderMenu(){
  menu.innerHTML = "";
  dates.forEach(d=>{
    const b=document.createElement("button");
    b.textContent=d.label;
    b.onclick=()=>selectDate(d.key,b);
    menu.appendChild(b);
  });
}

function renderSummary(){
  const wrap=document.getElementById("summaryWrapper");
  wrap.innerHTML = summaries.map(s=>`
    <div class="summary-card">
      <img src="${s.pic}">
      <div class="summary-content">
        <div class="summary-date">${s.date}</div>
        <div class="summary-text">${s.text}</div>
      </div>
    </div>
  `).join("");
}

function selectDate(key,btn){
  [...menu.children].forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");

  document.getElementById("pdfBar").style.display="block";
  document.getElementById("printDate").innerText =
    "Date: " + dates.find(d=>d.key===key).label;

  homeSection.style.display="none";
  scheduleSection.style.display="block";
  scheduleSection.innerHTML="";
  document.getElementById("pdfTableBody").innerHTML="";

  rows.filter(r=>r.key===key).forEach(r=>{
    document.getElementById("pdfTableBody").innerHTML += `
      <tr>
        <td>${r.time}</td>
        <td>${r.task}</td>
        <td>${r.name}</td>
        <td>${r.details||""}</td>
      </tr>
    `;

    scheduleSection.innerHTML += `
      <div class="card">
        <div class="card-header">${r.task}</div>
        <div class="card-body">
          <div class="info-box">üë§ ${r.name}</div>
          ${r.details?`<div class="info-box">üìù ${r.details}</div>`:""}
          <div class="time-badge">‚è± ${r.time}</div>
        </div>
      </div>
    `;
  });
}

function showHome(){
  homeSection.style.display="block";
  scheduleSection.style.display="none";
  document.getElementById("pdfBar").style.display="none";
  [...menu.children].forEach(b=>b.classList.remove("active"));
}
</script>

</body>
</html>
